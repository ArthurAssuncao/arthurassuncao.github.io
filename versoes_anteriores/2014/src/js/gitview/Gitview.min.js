var Gitview=(function(_1){var _2=function(_3){if(!_3||!_3.user){throw new Error("Gitview: missing user and/or domNode arg");}else{this.user=_3.user;this.domNode=_3.domNode?_3.domNode:document.body;this.compact=_3.compact==true?true:false;this.frame=true;this.showForks=_3.showForks==false?false:true;this.cache=_3.cache==false?false:true;this.count=_3.count?_3.count:3;this.w=_3.width?_3.width:"440px";this.w=this.w.substring(0,this.w.length-2)<300?"350px":this.w;this.theme=_3.theme||"light";this.frameColor=this.theme=="light"?"white":"#333";this.repos=[];this.entries=[];this.bottoms=[];this.tops=[];if(!Function.prototype.bind){Function.prototype.bind=this.bind;}this.loadScript("http://bitpshr.info/cdn/Gitgraph.min.js",this.postCreate.bind(this));}};_2.prototype={constructor:_2,postCreate:function(){if(this.frame){this.loadUser();}else{this.loadRepos();}},loadUser:function(){if(window.sessionStorage&&window.sessionStorage["user_data"+this.user]){var _4=JSON.parse(window.sessionStorage["user_data"+this.user]);this.createFrame();this.createFrameHeader(_4);this.loadRepos();}else{var _5=new XMLHttpRequest();var _6="http://bitpshr.info/cdn/ba-simple-proxy.php";var _7="?url=https://api.github.com/users/"+this.user;_5.open("GET",_6+_7,true);_5.onreadystatechange=function(){if(_5.readyState==4&&_5.status==200){var _8=JSON.parse(_5.responseText).contents;if(window.sessionStorage){window.sessionStorage["user_data"+this.user]=JSON.stringify(_8);}this.createFrame();this.createFrameHeader(_8);this.loadRepos();}}.bind(this);_5.send(null);}},loadRepos:function(){if(window.sessionStorage&&window.sessionStorage["repo_data"+this.user]){var _9=JSON.parse(window.sessionStorage["repo_data"+this.user]);this.repos=_9;this.sortRepos(this.repos);this._index=0;this._pageMax=this.count;for(var i=0;i<this.repos.length;i++){this.createRepoEntry(this.repos[i]);}this._repoCount=this.entries.length;}else{var _a=new XMLHttpRequest();var _b="http://bitpshr.info/cdn/ba-simple-proxy.php";var _c="?url=https://api.github.com/users/"+this.user+"/repos";_a.open("GET",_b+_c,true);_a.onreadystatechange=function(){if(_a.readyState==4&&_a.status==200){var _d=JSON.parse(_a.responseText).contents;console.log("data = ",_d);if(window.sessionStorage){window.sessionStorage["repo_data"+this.user]=JSON.stringify(_d);}this.repos=_d;this.sortRepos(this.repos);this._index=0;this._pageMax=this.count;for(var i=0;i<this.repos.length;i++){this.createRepoEntry(this.repos[i]);}this._repoCount=this.entries.length;}}.bind(this);_a.send(null);}},createFrame:function(){var _e=document.createElement("div");_e.style.cssText="box-shadow: 0 0 10px 3px #AAA;position:relative;text-align:left;line-height:15px;padding:5px 5px 30px 5px;"+"background:"+this.frameColor+";border-radius:3px;width:"+this.w+";";this.domNode.appendChild(_e);var _f=document.createElement("div");_f.style.cssText="height:100%;width:"+this.w+";";_e.appendChild(_f);var _10=document.createElement("a");_10.innerHTML=">";_10.style.cssText="cursor:pointer;cursor:hand;background-color: #eeeeee; background-image: -webkit-gradient(linear, left top, left bottom, "+"color-stop(0%, #eeeeee), color-stop(100%, #cccccc)); background-image: -webkit-linear-gradient(top, #eeeeee, #cccccc);"+" background-image: -moz-linear-gradient(top, #eeeeee, #cccccc); background-image: -ms-linear-gradient(top, #eeeeee, #cccccc); "+"background-image: -o-linear-gradient(top, #eeeeee, #cccccc); background-image: linear-gradient(top, #eeeeee, #cccccc);"+" border: 1px solid #ccc; border-bottom: 1px solid #bbb; border-radius: 2px; position:absolute; right:6px;bottom:4px;"+" color: #333; font: bold 11px/1 \"Lucida Grande\", \"Lucida Sans Unicode\", \"Lucida Sans\", Geneva, Verdana, sans-serif; "+"text-align: center; text-shadow: 0 1px 0 #eee; display:inline-block; line-height:20px;width:20px;height:20px;";_e.appendChild(_10);var _11=document.createElement("a");_11.innerHTML="<";_11.style.cssText="cursor:pointer;cursor:hand;background-color: #eeeeee; background-image: -webkit-gradient(linear, left top, left bottom, "+"color-stop(0%, #eeeeee), color-stop(100%, #cccccc)); background-image: -webkit-linear-gradient(top, #eeeeee, #cccccc);"+" background-image: -moz-linear-gradient(top, #eeeeee, #cccccc); background-image: -ms-linear-gradient(top, #eeeeee, #cccccc); "+"background-image: -o-linear-gradient(top, #eeeeee, #cccccc); background-image: linear-gradient(top, #eeeeee, #cccccc);"+" border: 1px solid #ccc; border-bottom: 1px solid #bbb; border-radius: 2px; position:absolute; right:33px;bottom:4px;"+" color: #333; font: bold 11px/1 \"Lucida Grande\", \"Lucida Sans Unicode\", \"Lucida Sans\", Geneva, Verdana, sans-serif; "+"text-align: center; text-shadow: 0 1px 0 #eee; display:inline-block; line-height:20px;width:20px;height:20px;";_e.appendChild(_11);_10.onclick=this.nextPage.bind(this);_11.onclick=this.prevPage.bind(this);this.domNode=_f;},createFrameHeader:function(_12){var _13=document.createElement("table");_13.style.cssText="height:45px;width:100%;border-spacing:0;"+"border-collapse:collapse;margin:0px;padding:0px;";this.domNode.parentNode.insertBefore(_13,this.domNode);var row=document.createElement("tr");_13.appendChild(row);var _14=document.createElement("td");_14.style.cssText="width:41px;vertical-align:top;padding:0px;";row.appendChild(_14);var _15=document.createElement("td");_15.style.cssText="padding-bottom: 4px;vertical-align: bottom;";row.appendChild(_15);var im=document.createElement("img");im.src=_12.avatar_url;im.style.cssText="width:40px;height:auto;border-radius:2px;position:relative;";_14.appendChild(im);var _16=document.createElement("span");_16.innerHTML=_12.login+"<br>";var _17=this.theme=="light"?"#333":"#EEE";_16.style.cssText="font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:13px;"+"color:"+_17+";font-weight:bold;margin-left:6px";_15.appendChild(_16);var t=document.createElement("span");t.innerHTML=_12.followers+" follower";t.style.cssText="font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:12px;color:#AAA;margin-left:6px";if(_12.followers>1||_12.followers==0){t.innerHTML+="s";}_15.appendChild(t);var v=document.createElement("span");v.innerHTML=" - "+_12.public_repos+" repositor";v.style.cssText="font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:12px;color:#AAA;";if(_12.public_repos>1||_12.public_repos==0){v.innerHTML+="ies";}else{v.innerHTML+="y";}_15.appendChild(v);var x=document.createElement("span");x.innerHTML="compact";x.style.cssText="font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:10px;color:#AAA;"+"cursor:hand;cursor:pointer;margin-left:5px;position:absolute;top:33px;right:27px";this.domNode.parentNode.insertBefore(x,this.domNode);var w=document.createElement("span");w.innerHTML="full";w.style.cssText="font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;"+"font-size:10px;color:#AAA;cursor:hand;cursor:pointer;"+"position:absolute;top:33px;right:7px";this.domNode.parentNode.insertBefore(w,this.domNode);w.onclick=this.toggleFull.bind(this);x.onclick=this.toggleCompact.bind(this);},createRepoEntry:function(obj,_18){if(!obj.fork||(obj.fork&&this.showForks)){this.domNode.style.borderBottom="1px solid #DDD";this.domNode.style.background="white";this.domNode.style.borderRadius="2px";var _19=document.createElement("div");_19.className="entry";_19.style.cssText="border-radius:2px;padding-top: 5px;text-align:left;border-top:1px solid #DDD;background:white;";this.domNode.appendChild(_19);this.entries.push(_19);if(!this.frame){_19.style.width=this.w;}if(this.compact){_19.style.marginBottom="5px";}if(this._index>=this.count){_19.style.display="none";}var top=this.createTop(obj,_19);this.tops.push(top);var _1a=this.createBottom(obj,_19);this.bottoms.push(_1a);this._index++;}},createTop:function(obj,_1b){var top=document.createElement("div");top.className="top";top.style.cssText="height:32px;line-height:32px;position:relative;";_1b.appendChild(top);if(this.compact){top.style.borderBottom="0px";}var s=(obj.fork)?"http://bitpshr.info/cdn/fork.png":"http://bitpshr.info/cdn/gh-public.png";var im=document.createElement("img");im.src=s;im.style.cssText="position:absolute;left:4px;top:2px";top.appendChild(im);var _1c=document.createElement("a");_1c.innerHTML=obj.name;_1c.href="https://github.com/"+this.user+"/"+obj.name;_1c.style.cssText="color:#4183C4;font-size:24px;font-weight:bold;Helvetica, arial, freesans, clean, sans-serif;letter-spacing:-1px;position:absolute;"+"left:35px;text-decoration:none";top.appendChild(_1c);var _1d=document.createElement("div");_1d.style.cssText="position:relative;display:inline-block;float:right;color:#666;font-size:11px;"+"font-family:arial;font-weight:bold;height:32px;";top.appendChild(_1d);if(obj.language){var s=document.createElement("span");s.style.cssText="position:absolute;left:-180px;height:32px;line-height:32px;";s.innerHTML=obj.language;_1d.appendChild(s);}var _1e=document.createElement("a");_1e.innerHTML="<img style=\"position:absolute;top:50%;left:-20px;margin-top:-8px;\" src=\"http://bitpshr.info/cdn/star.png\"/>"+"<font color=\"#666;\">"+obj.watchers+"</font>";_1e.href="https://github.com/"+this.user+"/"+obj.name+"/watchers";_1e.style.cssText="color:gray;position:absolute;left:-85px;height:32px;line-height:32px;text-decoration:none;";_1d.appendChild(_1e);var _1f=document.createElement("a");_1f.innerHTML="<img style=\"position:absolute;top:50%;left:-20px;margin-top:-8px;\" src=\"http://bitpshr.info/cdn/forks.png\"/>"+"<font color=\"#666;\">"+obj.forks+"</font>";_1f.href="https://github.com/"+this.user+"/"+obj.name+"/network";_1f.style.cssText="color:gray;position:absolute;left:-35px;height:32px;line-height:32px;text-decoration:none;";_1d.appendChild(_1f);return top;},createBottom:function(obj,_20){var _21=document.createElement("div");_21.className="bottom";_21.style.cssText="position:relative;border-bottom-right-radius:3px;border-bottom-left-radius:3px;padding-bottom:5px;padding-top:5px;height:74px;";_20.appendChild(_21);if(!this._tmpW){this._tmpW=(_20.offsetWidth-47);}var _22=new Gitgraph({user:this.user,repo:obj.name,showName:false,domNode:_21,width:this._tmpW,allColor:"#EEEEEE",userColor:"#BBBBBB",height:80});var _23=_21.firstChild;_23.style.cssText="margin-left:35px;position:absolute;top:0px;";_23.style.marginLeft="35px";var d=obj.description;if(d.length>100){d=d.slice(0,97)+"...";}var _24=document.createElement("div");_24.innerHTML=d;_24.style.cssText="position:absolute;top:10px;font-family:Helvetica, arial, freesans, clean, sans-serif;"+"font-size:14px;margin-left:35px;height:30px;color:#333;";_21.appendChild(_24);if(this.compact){_21.style.display="none";}return _21;},fixUpdateDate:function(_25){return _25;},nextPage:function(){var _26=this._pageMax;this._pageMax=((this._pageMax+this.count)<=this._repoCount)?(this._pageMax+this.count):this._repoCount;var _27=this._pageMax;if(_26!=_27){for(var i=0;i<this.entries.length;i++){if(i<_26){this.entries[i].style.display="none";}else{if(i<_27){this.entries[i].style.display="block";}}}}},prevPage:function(){var _28=0;for(var o=0;o<this.entries.length;o++){if(this.entries[o].style.display!="none"){_28++;}}this._pageMax=((this._pageMax-_28)>=this.count)?(this._pageMax-_28):this.count;var _29=this._pageMax;var _2a=((this._pageMax-this.count)>=0)?(this._pageMax-this.count):0;if(!((_29==_2a)&&(_29==0))){for(var i=0;i<this.entries.length;i++){if(i>=_29){this.entries[i].style.display="none";}else{if(i>=_2a){this.entries[i].style.display="block";}}}}},toggleFull:function(){for(var i=0;i<this.bottoms.length;i++){this.bottoms[i].style.display="block";}for(var j=0;j<this.bottoms.length;j++){this.bottoms[j].style.borderBottom="1px solid #DDD1px solid #DDD";}},toggleCompact:function(){for(var i=0;i<this.bottoms.length;i++){this.bottoms[i].style.display="none";}for(var j=0;j<this.bottoms.length;j++){this.bottoms[j].style.borderBottom="0px";}},sortRepos:function(arr){arr.sort(function(a,b){var _2b=new Date(a.pushed_at),_2c=new Date(b.pushed_at);if(_2b<_2c){return -1;}if(_2b>_2c){return 1;}return 0;});arr.reverse();},loadScript:function(_2d,_2e){var _2f=document.getElementsByTagName("head")[0];if(_2f){var _30=document.createElement("script");_30.setAttribute("src",_2d);_30.setAttribute("type","text/javascript");var _31=function(){if(this.readyState=="complete"||this.readyState=="loaded"){_2e();}};_30.onreadystatechange=_31;_30.onload=_2e;_2f.appendChild(_30);}},bind:function(_32){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}var _33=Array.prototype.slice.call(arguments,1),_34=this,_35=function(){},_36=function(){return _34.apply(this instanceof _35?this:_32||window,_33.concat(Array.prototype.slice.call(arguments)));};_35.prototype=this.prototype;_36.prototype=new _35();return _36;}};return _2;}());